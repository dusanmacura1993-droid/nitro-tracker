<!DOCTYPE html>
<html lang="sr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mandrilos Mechanic ‚Äì Control Panel</title>

  <!-- Firebase (compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <style>
    :root{
      --bg:#0a0a0a;
      --panel:#111;
      --panel2:#141414;
      --line:#2a2a2a;
      --text:#eaeaea;
      --muted:#a9a9a9;
      --accent:#e53935;
      --danger:#b71c1c;
      --ok:#2ecc71;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: Arial, Helvetica, sans-serif;
      background:var(--bg);
      color:var(--text);
    }

    /* HEADER (full black) */
    header{
      background:#000;
      border-bottom:1px solid #111;
      display:flex;
      align-items:center;
      gap:14px;
      padding:14px 18px;
    }
    .logo{
      height:54px;
      width:auto;
      display:block;
    }
    .brand{
      display:flex;
      flex-direction:column;
      line-height:1.1;
    }
    .brand .title{
      font-weight:900;
      letter-spacing:2px;
      font-size:18px;
    }
    .brand .sub{
      font-size:12px;
      color:var(--muted);
      margin-top:4px;
      letter-spacing:1px;
    }

    /* TABS */
    .tabs{
      background:#0d0d0d;
      border-bottom:1px solid #1c1c1c;
      padding:12px 12px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .tab{
      padding:10px 14px;
      border-radius:10px;
      border:1px solid #2c2c2c;
      background:#151515;
      color:var(--text);
      cursor:pointer;
      font-weight:800;
      letter-spacing:.5px;
      transition:.15s;
    }
    .tab:hover{ transform:translateY(-1px); }
    .tab.active{
      background:var(--accent);
      border-color:var(--accent);
    }

    /* LAYOUT */
    .wrap{ padding:18px; }
    .section{ display:none; animation:fade .18s ease; }
    .section.active{ display:block; }
    @keyframes fade{
      from{ opacity:0; transform:translateY(5px); }
      to{ opacity:1; transform:none; }
    }

    /* PANELS */
    .box{
      background:var(--panel);
      border:1px solid var(--line);
      border-radius:14px;
      padding:14px;
      margin:12px 0;
      max-width:980px;
    }
    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }

    input{
      background:#1a1a1a;
      border:1px solid #333;
      color:#fff;
      border-radius:10px;
      padding:10px 12px;
      min-width:240px;
      outline:none;
    }
    input:focus{ border-color:#555; }

    .btn{
      border:none;
      border-radius:10px;
      padding:10px 14px;
      font-weight:900;
      cursor:pointer;
      background:var(--accent);
      color:#fff;
      transition:.15s;
      letter-spacing:.3px;
    }
    .btn:hover{ opacity:.95; transform:translateY(-1px); }
    .btn:active{ transform:translateY(0px); }
    .btn.dark{ background:#2a2a2a; }
    .btn.danger{ background:var(--danger); }

    .notice{
      font-size:13px;
      color:var(--muted);
      margin-top:8px;
      line-height:1.35;
    }

    /* JOB GRID */
    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      max-width:980px;
    }
    @media (max-width: 860px){
      .grid{ grid-template-columns: 1fr; }
    }
    .item{
      background:var(--panel2);
      border:1px solid var(--line);
      border-radius:14px;
      padding:12px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    .item .name{ font-weight:900; }
    .item .small{ font-size:12px; color:var(--muted); margin-top:4px; }
    .item .actions{ display:flex; gap:10px; align-items:center; }
    .qty{
      min-width:32px;
      text-align:center;
      font-weight:900;
      color:#9ef7d5;
    }

    /* KPIs */
    .kpis{
      display:grid;
      grid-template-columns: repeat(3, minmax(180px, 1fr));
      gap:10px;
      max-width:980px;
    }
    @media (max-width: 860px){
      .kpis{ grid-template-columns: 1fr; }
    }
    .kpi{
      background:#0f0f0f;
      border:1px solid var(--line);
      border-radius:14px;
      padding:12px;
    }
    .kpi .label{ font-size:12px; color:var(--muted); }
    .kpi .val{ font-size:18px; font-weight:900; margin-top:4px; }

    /* TABLES */
    table{
      width:min(980px,100%);
      border-collapse:collapse;
      overflow:hidden;
      border-radius:14px;
    }
    th,td{
      border:1px solid #303030;
      padding:8px;
      text-align:center;
    }
    th{
      background:#0f0f0f;
      color:#ff7b78;
      font-weight:900;
    }
    td{ background:#0c0c0c; }

    /* TOAST */
    .toast{
      position:fixed;
      right:16px;
      bottom:16px;
      background:#1d1d1d;
      border:1px solid #333;
      color:#fff;
      padding:10px 12px;
      border-radius:14px;
      opacity:0;
      transform:translateY(8px);
      transition:.18s;
      z-index:9999;
      max-width: 90vw;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .toast.show{ opacity:1; transform:none; }
  </style>
</head>

<body>
  <header>
    <img src="assets/logo.png" class="logo" alt="Mandrilos Logo">
    <div class="brand">
      <div class="title">MANDRILOS MECHANIC</div>
      <div class="sub">Control Panel</div>
    </div>
  </header>

  <div class="tabs">
    <button class="tab active" data-target="customer">Customer</button>
    <button class="tab" data-target="mechanic">Mehaniƒçar</button>
    <button class="tab" data-target="public">Statistika</button>
    <button class="tab" data-target="nitro">Nitro</button>
    <button class="tab" data-target="admin">Admin</button>
  </div>

  <div class="wrap">

    <!-- CUSTOMER -->
    <section id="customer" class="section active">
      <h2>Raƒçun za mu≈°teriju</h2>
      <div class="box">
        <div class="notice">Mu≈°terija vidi samo stavke + konaƒçnu cenu. Ne vidi interne tro≈°kove.</div>
        <div id="customerList" class="notice" style="margin-top:10px"></div>

        <div class="kpis" style="margin-top:12px">
          <div class="kpi">
            <div class="label">UKUPNO</div>
            <div class="val" id="custTotal">0$</div>
          </div>
        </div>
      </div>
    </section>

    <!-- MECHANIC -->
    <section id="mechanic" class="section">
      <h2>Mehaniƒçar</h2>

      <div class="box">
        <div class="row">
          <input id="mechName" placeholder="Unesi svoje ime (npr. Markoviƒá)">
          <button class="btn" id="btnLogin">UƒêI</button>
          <button class="btn dark" id="btnLogout">ODJAVA</button>
        </div>
        <div class="notice">Ulogovan: <b id="mechLabel">‚Äî</b></div>
        <div class="notice">Mehaniƒçar vidi samo svoje: naplaƒáeno / zarada / za banku.</div>
      </div>

      <div class="box">
        <h3>Dodaj posao (+1)</h3>
        <div id="jobGrid" class="grid"></div>
      </div>

      <div class="box">
        <h3>Moja raƒçunica</h3>
        <div class="kpis">
          <div class="kpi"><div class="label">MOJE NAPLAƒÜENO</div><div class="val" id="meNaplatio">0$</div></div>
          <div class="kpi"><div class="label">MOJA ZARADA</div><div class="val" id="meZarada">0$</div></div>
          <div class="kpi"><div class="label">ZA BANKU (FIRMA)</div><div class="val" id="meBanka">0$</div></div>
        </div>
        <div class="notice">Full tune & Custom sound: bonus 10% se raƒçuna na kraju nedelje (admin).</div>
      </div>
    </section>

    <!-- PUBLIC -->
    <section id="public" class="section">
      <h2>Javna statistika (svi vide)</h2>
      <div class="box">
        <table>
          <thead><tr><th>Mehaniƒçar</th><th>Full tune</th><th>Custom sound</th></tr></thead>
          <tbody id="publicBody"></tbody>
        </table>
        <div class="notice">Ovo je samo broj uraƒëenih Full/Sound po imenu.</div>
      </div>
    </section>

    <!-- NITRO -->
    <section id="nitro" class="section">
      <h2>Nitro & Materijali (live)</h2>
      <div class="box">
        <div class="notice">Samo svoj red mo≈æe≈° da menja≈°. Ostalo je read-only.</div>
        <table>
          <thead>
            <tr>
              <th>Ime</th><th>Nitro</th><th>Guma (Tire)</th><th>Aluminijum (Aluminum)</th><th>ƒåelik (Steel)</th><th>Skarp (Scrap)</th>
            </tr>
          </thead>
          <tbody id="nitroBody"></tbody>
        </table>
      </div>
    </section>

    <!-- ADMIN -->
    <section id="admin" class="section">
      <h2>Admin</h2>

      <div class="box" id="adminLock">
        <div class="row">
          <input type="password" id="adminPin" placeholder="PIN (2468)">
          <button class="btn" id="btnAdminUnlock">OTKLJUƒåAJ</button>
        </div>
        <div class="notice">Samo admin ima export/reset i upravljanje mehaniƒçarima.</div>
      </div>

      <div id="adminPanel" style="display:none">
        <div class="box">
          <h3>Dodaj mehaniƒçara</h3>
          <div class="row">
            <input id="newMech" placeholder="Novo ime">
            <button class="btn" id="btnAddMech">DODAJ</button>
          </div>

          <h3 style="margin-top:14px">Lista mehaniƒçara</h3>
          <table>
            <thead><tr><th>Ime</th><th>Status</th><th>Akcija</th></tr></thead>
            <tbody id="mechBody"></tbody>
          </table>
        </div>

        <div class="box">
          <h3>Nitro ‚Äì Admin</h3>
          <div class="row">
            <button class="btn" id="btnNitroCSV">üì§ Export Nitro CSV</button>
            <button class="btn" id="btnNitroTXT">üì§ Export Nitro TXT</button>
            <button class="btn danger" id="btnNitroReset">üîÑ Reset Nitro</button>
          </div>
          <div class="notice">Reset bri≈°e samo Nitro podatke.</div>
        </div>

        <div class="box">
          <h3>Nedeljni bonus 10% (Full + Sound)</h3>
          <button class="btn" id="btnWeekly">üßÆ Izraƒçunaj</button>
          <div id="weeklyResult" class="notice" style="margin-top:10px"></div>
        </div>
      </div>
    </section>

  </div>

  <div id="toast" class="toast"></div>

  <script>
    /* ===================== FIREBASE INIT ===================== */
    firebase.initializeApp({
      apiKey: "AIzaSyAbxxQyWyf9iAT_AE9b-o41BRqcrnXaNy8",
      authDomain: "nitro-55cdd.firebaseapp.com",
      databaseURL: "https://nitro-55cdd-default-rtdb.firebaseio.com",
      projectId: "nitro-55cdd",
      storageBucket: "nitro-55cdd.appspot.com",
      messagingSenderId: "365206404307",
      appId: "1:365206404307:web:794d0420e125760a572826"
    });
    const db = firebase.database();

    /* ===================== CONFIG ===================== */
    const PRICES = {
      full:{cust:100000}, sound:{cust:200000},
      tint:{cust:2400, cost:1200},
      paint:{cust:2400, cost:1200},
      stance:{cust:50000, cost:25000},
      wsize:{cust:50000, cost:25000},
      wwidth:{cust:50000, cost:25000},
      rims:{cust:6000, cost:3000},
      drift:{cust:7500, cost:3750},
      xenon:{cust:6000, cost:3000},
      neon:{cust:20000, cost:10000},
      horn:{cust:1500, cost:750},
      armor:{cust:9000, cost:4500},
      wash:{cust:1000, cost:500},
      repair:{cust:4000, cost:2000},
      tracker:{cust:2400, cost:1200}
    };

    const JOBS_UI = [
      {k:"full",  title:"Full tune", sub:"Kompletan tuning"},
      {k:"sound", title:"Custom sound", sub:"Poseban zvuk"},
      {k:"tint",  title:"Window tint", sub:"Zatamnjivanje"},
      {k:"paint", title:"Paint", sub:"Farbanje"},
      {k:"stance",title:"Wheels stance", sub:"Stance"},
      {k:"wsize", title:"Wheel size", sub:"Veliƒçina toƒçka"},
      {k:"wwidth",title:"Wheel width", sub:"≈†irina felne"},
      {k:"rims",  title:"Rims", sub:"Felne"},
      {k:"drift", title:"Drift tires", sub:"Drift gume"},
      {k:"xenon", title:"Xenon", sub:"Xenon svetla"},
      {k:"neon",  title:"Neons", sub:"Neoni"},
      {k:"horn",  title:"Horn", sub:"Sirena"},
      {k:"armor", title:"Armor", sub:"Oklop"},
      {k:"wash",  title:"Wash", sub:"Pranje"},
      {k:"repair",title:"Repair", sub:"Popravka"},
      {k:"tracker",title:"Tracker", sub:"Lokator"}
    ];

    /* ===================== STATE ===================== */
    let mech = localStorage.getItem("mechanic") || "";
    let adminUnlocked = false;
    let cart = {}; // customer view current session

    const $ = (id)=>document.getElementById(id);
    const money = (n)=>(Number(n)||0).toLocaleString()+"$";

    function toast(msg){
      const t = $("toast");
      t.textContent = msg;
      t.classList.add("show");
      setTimeout(()=>t.classList.remove("show"), 1200);
    }

    /* ===================== TABS ===================== */
    function setTab(targetId){
      document.querySelectorAll(".tab").forEach(b=>b.classList.remove("active"));
      document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
      document.querySelector(`.tab[data-target="${targetId}"]`)?.classList.add("active");
      $(targetId)?.classList.add("active");
    }

    /* ===================== LABELS ===================== */
    function labelItem(k){
      const map = {
        full:"Full tune (Kompletan tuning)",
        sound:"Custom sound (Poseban zvuk)",
        tint:"Window tint (Zatamnjivanje)",
        paint:"Paint (Farbanje)",
        stance:"Wheels stance (Stance)",
        wsize:"Wheel size (Veliƒçina toƒçka)",
        wwidth:"Wheel width (≈†irina felne)",
        rims:"Rims (Felne)",
        drift:"Drift tires (Drift gume)",
        xenon:"Xenon (Xenon svetla)",
        neon:"Neons (Neoni)",
        horn:"Horn (Sirena)",
        armor:"Armor (Oklop)",
        wash:"Wash (Pranje)",
        repair:"Repair (Popravka)",
        tracker:"Tracker (Lokator)"
      };
      return map[k] || k;
    }

    /* ===================== CUSTOMER ===================== */
    function renderCustomer(){
      let total = 0;
      let lines = [];
      Object.keys(cart).forEach(k=>{
        const qty = cart[k]||0;
        if(!qty) return;
        const price = PRICES[k].cust * qty;
        total += price;
        lines.push(`${labelItem(k)} x${qty} ‚Üí ${money(price)}`);
      });
      $("customerList").innerHTML = lines.length ? lines.join("<br>") : "Nema unosa jo≈°.";
      $("custTotal").textContent = money(total);
    }

    /* ===================== MECH STATS ===================== */
    function computeForMechanic(entries){
      let naplatio=0, banka=0, zarada=0;
      entries.forEach(e=>{
        naplatio += e.customer||0;
        const item = e.item;
        if(item==="full") banka += 100000;
        else if(item==="sound") banka += 200000;
        else{
          const cost = PRICES[item]?.cost || 0;
          banka += cost;
          zarada += ((e.customer||0) - cost);
        }
      });
      return {naplatio,banka,zarada};
    }

    function bindMyStats(){
      if(!mech) return;
      db.ref("jobs").orderByChild("mechanic").equalTo(mech).on("value", snap=>{
        const entries=[];
        snap.forEach(s=>entries.push(s.val()));
        const r = computeForMechanic(entries);
        $("meNaplatio").textContent = money(r.naplatio);
        $("meBanka").textContent   = money(r.banka);
        $("meZarada").textContent  = money(r.zarada);
      });
    }

    /* ===================== PUBLIC ===================== */
    db.ref("publicStats").on("value", snap=>{
      const tb = $("publicBody");
      tb.innerHTML = "";
      snap.forEach(m=>{
        const v=m.val()||{};
        tb.innerHTML += `<tr><td>${m.key}</td><td>${v.full||0}</td><td>${v.sound||0}</td></tr>`;
      });
    });

    /* ===================== NITRO ===================== */
    const nitroRef = db.ref("nitro");

    function ensureNitroRow(name){
      if(!name) return;
      nitroRef.child(name).once("value").then(s=>{
        if(!s.exists()){
          nitroRef.child(name).set({nitro:0,tire:0,aluminum:0,steel:0,scrap:0});
        }
      });
    }

    function updateNitro(name, key, value){
      const v = Math.max(0, Number(value)||0);
      nitroRef.child(name).child(key).set(v);
    }

    nitroRef.on("value", snap=>{
      const tb = $("nitroBody");
      tb.innerHTML = "";
      snap.forEach(m=>{
        const d = m.val()||{};
        const canEdit = (m.key === mech);
        const cell = (key,val)=>{
          if(!canEdit) return `<td>${val||0}</td>`;
          return `<td><input data-nname="${m.key}" data-nkey="${key}" type="number" min="0" value="${val||0}" style="min-width:90px"></td>`;
        };
        tb.innerHTML += `
          <tr>
            <td>${m.key}</td>
            ${cell("nitro",d.nitro)}
            ${cell("tire",d.tire)}
            ${cell("aluminum",d.aluminum)}
            ${cell("steel",d.steel)}
            ${cell("scrap",d.scrap)}
          </tr>
        `;
      });
      tb.querySelectorAll("input[data-nname]").forEach(inp=>{
        inp.addEventListener("change", ()=>{
          updateNitro(inp.dataset.nname, inp.dataset.nkey, inp.value);
        });
      });
    });

    /* ===================== ADMIN MECHANICS ===================== */
    const mechRef = db.ref("mechanics");

    function addMechanic(){
      if(!adminUnlocked) return alert("Admin samo");
      const name = $("newMech").value.trim();
      if(!name) return alert("Unesi ime");
      mechRef.child(name).set({active:true});
      $("newMech").value="";
      toast("Dodat mehaniƒçar");
    }

    function deactivateMech(name){
      if(!adminUnlocked) return;
      if(!confirm("Sigurno otkaz za "+name+"?")) return;
      mechRef.child(name).update({active:false});
      toast("Deaktiviran");
    }

    mechRef.on("value", snap=>{
      const tb = $("mechBody");
      if(!tb) return;
      tb.innerHTML = "";
      snap.forEach(m=>{
        const d=m.val()||{};
        tb.innerHTML += `
          <tr>
            <td>${m.key}</td>
            <td>${d.active ? "Aktivan" : "Neaktivan"}</td>
            <td>${d.active ? `<button class="btn danger" data-fire="${m.key}">OTKAZ</button>` : "‚Äî"}</td>
          </tr>
        `;
      });
      tb.querySelectorAll("button[data-fire]").forEach(b=>{
        b.addEventListener("click", ()=>deactivateMech(b.dataset.fire));
      });
    });

    /* ===================== ADMIN EXPORT/RESET NITRO ===================== */
    function downloadFile(filename, content, type){
      const blob = new Blob([content], {type});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href=url; a.download=filename;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    function exportNitroCSV(){
      if(!adminUnlocked) return alert("Admin samo");
      db.ref("nitro").once("value").then(snap=>{
        let csv="mechanic,nitro,tire,aluminum,steel,scrap\n";
        snap.forEach(s=>{
          const d=s.val()||{};
          csv += `${s.key},${d.nitro||0},${d.tire||0},${d.aluminum||0},${d.steel||0},${d.scrap||0}\n`;
        });
        downloadFile("nitro.csv", csv, "text/csv");
      });
    }

    function exportNitroTXT(){
      if(!adminUnlocked) return alert("Admin samo");
      db.ref("nitro").once("value").then(snap=>{
        let txt="NITRO LISTING\n\n";
        snap.forEach(s=>{
          const d=s.val()||{};
          txt += `${s.key}: NITRO ${d.nitro||0}, TIRE ${d.tire||0}, ALU ${d.aluminum||0}, STEEL ${d.steel||0}, SCRAP ${d.scrap||0}\n`;
        });
        downloadFile("nitro.txt", txt, "text/plain");
      });
    }

    function resetNitro(){
      if(!adminUnlocked) return alert("Admin samo");
      if(!confirm("SIGURNO? Ovo bri≈°e sve Nitro podatke!")) return;
      db.ref("nitro").remove();
      toast("Nitro resetovan");
    }

    /* ===================== WEEKLY BONUS ===================== */
    function computeWeeklyBonus(){
      if(!adminUnlocked) return alert("Admin samo");
      db.ref("jobs").once("value").then(snap=>{
        const perMech = {};
        let firmProfit = 0;
        snap.forEach(s=>{
          const d=s.val();
          if(d.item === "full"){
            firmProfit += 65000;
            perMech[d.mechanic] = (perMech[d.mechanic]||0) + 65000;
          }
          if(d.item === "sound"){
            firmProfit += 50000;
            perMech[d.mechanic] = (perMech[d.mechanic]||0) + 50000;
          }
        });

        let html = `<b>Zarada firme (Full+Sound):</b> ${money(firmProfit)}<br><br>`;
        html += `<b>Bonusi (10%):</b><br>`;
        Object.keys(perMech).forEach(m=>{
          const bonus = Math.round(perMech[m] * 0.10);
          html += `${m}: ${money(bonus)}<br>`;
        });
        $("weeklyResult").innerHTML = html;
      });
    }

    /* ===================== JOB BUTTONS ===================== */
    function buildJobButtons(){
      const grid = $("jobGrid");
      grid.innerHTML = "";
      JOBS_UI.forEach(j=>{
        const el = document.createElement("div");
        el.className = "item";
        el.innerHTML = `
          <div>
            <div class="name">${j.title}</div>
            <div class="small">${j.sub}</div>
          </div>
          <div class="actions">
            <span class="qty" id="qty_${j.k}">0</span>
            <button class="btn" data-job="${j.k}">+1</button>
          </div>
        `;
        grid.appendChild(el);
      });

      grid.querySelectorAll("button[data-job]").forEach(b=>{
        b.addEventListener("click", ()=>{
          if(!mech){ alert("Uloguj se imenom prvo."); return; }
          const k = b.dataset.job;
          cart[k] = (cart[k]||0)+1;
          $("qty_"+k).textContent = cart[k];

          db.ref("jobs").push({ mechanic: mech, item: k, customer: PRICES[k].cust, time: Date.now() });
          if(k==="full" || k==="sound"){
            db.ref("publicStats/"+mech+"/"+k).transaction(v=>(v||0)+1);
          }

          renderCustomer();
          toast("Dodato: "+labelItem(k));
        });
      });
    }

    /* ===================== AUTH ===================== */
    function loginMechanic(){
      const name = $("mechName").value.trim();
      if(!name) return alert("Unesi ime");
      mech = name;
      localStorage.setItem("mechanic", mech);
      $("mechLabel").textContent = mech;
      ensureNitroRow(mech);
      bindMyStats();
      toast("Ulogovan: "+mech);
    }

    function logoutMechanic(){
      mech = "";
      localStorage.removeItem("mechanic");
      $("mechLabel").textContent = "‚Äî";
      toast("Odjava");
    }

    function unlockAdmin(){
      const pin = $("adminPin").value;
      if(pin === "2468"){
        adminUnlocked = true;
        $("adminLock").style.display = "none";
        $("adminPanel").style.display = "block";
        toast("Admin OK");
      }else{
        alert("Pogre≈°an PIN");
      }
    }

    /* ===================== INIT ===================== */
    document.addEventListener("DOMContentLoaded", ()=>{
      document.querySelectorAll(".tab").forEach(b=>{
        b.addEventListener("click", ()=>setTab(b.dataset.target));
      });

      $("btnLogin").addEventListener("click", loginMechanic);
      $("btnLogout").addEventListener("click", logoutMechanic);
      $("btnAdminUnlock").addEventListener("click", unlockAdmin);

      $("btnAddMech").addEventListener("click", addMechanic);
      $("btnNitroCSV").addEventListener("click", exportNitroCSV);
      $("btnNitroTXT").addEventListener("click", exportNitroTXT);
      $("btnNitroReset").addEventListener("click", resetNitro);
      $("btnWeekly").addEventListener("click", computeWeeklyBonus);

      buildJobButtons();

      if(mech){
        $("mechLabel").textContent = mech;
        ensureNitroRow(mech);
        bindMyStats();
      }

      renderCustomer();
    });
  </script>
</body>
</html>
